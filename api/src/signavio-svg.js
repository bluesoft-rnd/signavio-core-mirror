(function(){var aa=function(ba){if(!ba){throw new Error("The Signavio Mashup API needs a configuration.");}
if("string"==typeof ba.element){ba.element=document.getElementById(ba.element);}
this.config=ba;this.init();}
aa.prototype={server:"http://academic.signavio.com",init:function(){this.writeContent(this.setupIFrame());},onLoaded:function(){this.Ext=this.frame.Ext;this.ORYX=this.frame.ORYX;this.Ajax=this.frame.Ajax;this.$A=this.frame.$A;this.Template=this.frame.Template;this.Ext.data.HttpProxy.prototype.load=function(){};this.setupEditor();},onRendered:function(){var ca=this.editor.getCanvas(),size=this.getShapeSize(),zoom=this.config.zoom,me=this,width=this.document.offsetWidth,height=this.document.offsetHeight;if("undefined"==typeof zoom){zoom=100;if(this.config.overflowX=="fit"){zoom=Math.min(zoom,(width/(size.width()+20))*100);}
if(this.config.overflowY=="fit"){zoom=Math.min(zoom,(height/(size.height()+20))*100);}}
zoom=Math.max(Math.min(zoom,100),1)/100;ca.setZoom(zoom);ca.setSize({width:((size.width()+20)*zoom),height:((size.height()+20)*zoom)});ca.node.setAttribute("transform",me.editor.getCanvas().node.getAttribute("transform")+" translate("+(-1*(size.upperLeft().x-10))+", "+(-1*(size.upperLeft().y-10))+")");var da=function(st){me.frame.SVGElement=SVGElement;var ea=new me.frame.DOMParser();var fa=ea.parseFromString('<svg xmlns="http://www.w3.org/2000/svg">'+st+'</svg>',"text/xml");return fa.childNodes[0].childNodes[0];}
var ga=function(ha){if("string"==typeof ha){ha=ca.getChildShapeByResourceId(ha);}
if(ha instanceof me.ORYX.Core.Shape){me.editor.handleEvents({type:me.ORYX.CONFIG.EVENT_OVERLAY_SHOW,id:"Overlay_focus"+(ha.id),shapes:me.$A([ha]),node:da(["<rect ","class='x-focus-rectangle' ","x='-5' ","y='-5' ","width='",(ha.bounds.width()+10),"' ","height='",(ha.bounds.height()+10),"' ","stroke='#AD0F5B' stroke-width='2' ","fill='none' ","rx='4' ry='4' ","></rect>"].join("")),nodePosition:"NW"});return;}
if("object"!=typeof ha){return;}
if("undefined"===typeof ha.nodes){ha.nodes=ca.getChildNodes(true);}
var ia=me.$A([].concat(ha.nodes)).map(function(ja){return ja instanceof me.ORYX.Core.Shape?ja:ca.getChildShapeByResourceId(ja);}).compact();if(ha.properties){var ka=ha.template||"<text stroke='none'>#{0}</text>";var la=ha.templateFn instanceof Function?ha.templateFn:function(){return ka};var ma=[].concat(ha.properties);for(var i=0,size=ia.length;i<size;++i){var na=ia[i];if(na instanceof me.ORYX.Core.Shape){var oa=[];for(var j=0,ps=ma.length;j<ps;++j){var pa=na.properties[ma[j]];if(pa===undefined){pa=na.hiddenProperties[ma[j]]}
if(pa===undefined){pa="";}
oa.push(pa);}
me.editor.handleEvents({type:me.ORYX.CONFIG.EVENT_OVERLAY_SHOW,id:na.id,shapes:me.$A([na]),node:da(new me.Template(la(oa,na)).evaluate(oa)),nodePosition:ha.position||"NE"});}}}
if(ha.attributes){me.editor.handleEvents({type:me.ORYX.CONFIG.EVENT_OVERLAY_SHOW,id:"Overlay_attribtues"+(Math.round(Math.random()*1000000)),shapes:ia,attributes:ha.attributes});}}
this.$A([].concat(this.config.focus)).each(ga);this.$A([].concat(this.config.focus)).each(function(qa){})if(this.config.click instanceof Function){var ra=this.config.click;this.editor.registerOnEvent("click",function(sa,ta){if(ta instanceof me.ORYX.Core.Shape){ra.call(ra,ta,me.editor,sa);}});}
var ua=document.createElement("div");ua.innerHTML='<a href="http://www.signavio.com" style="display:block;position:absolute;left:3px;bottom:20px;width:80px;height:30px;color:transparent;background-image:url(http://editor.signavio.com/mashup/img/signavio.png);background-attachment:scroll;background-origin:initial;background-clip:initial;background-color:transparent;cursor:pointer;z-index:100;background-position:0px 0px;background-repeat:no-repeat no-repeat; ">&nbsp;</a>' ca.getScrollNode().appendChild(ua);this.ORYX.Editor.prototype._finishedLoading.apply(this.editor,[]);if(this.config.callback instanceof Function){this.config.callback.call(this.config.callback,this.editor,this);}},setupEditor:function(){var me=this;this.ORYX.availablePlugins=this.getPlugins();this.ORYX.Editor.prototype._loadStencilSetExtensionConfig=function(){};this.ORYX.Editor.prototype._generateGUI=function(){this.layout_regions={center:new me.Ext.Panel({region:'center',cls:'x-panel-editor-center',autoScroll:true,items:{layout:"fit",autoHeight:true,el:this.getCanvas().rootNode.parentNode}}),east:{collapse:function(){}},west:{collapse:function(){}}};this.layout=new me.Ext.Viewport({layout:'border',items:[this.layout_regions.center]});this.getCanvas().rootNode.parentNode.style.border="none";};this.load(function(va){me.editor=new me.ORYX.Editor({id:'oryx-canvas123',fullscreen:true,stencilset:{url:va.stencilset.namespace},model:va});me.editor._finishedLoading=function(){me.beforeFinishedRendered();}});},beforeFinishedRendered:function(){var wa=[],count=0,me=this;var xa=function(){if(--count===0){for(var i=0,size=wa.length;i<size;++i){wa[i].changeCallbacks.pop();}
me.onRendered();}};this.editor.getCanvas().getChildShapes(true).each(function(ya){ya.getLabels().each(function(za){if(za.isUpdating()&&++count){za.changeCallbacks.push(xa);wa.push(za);}})});if(count===0){this.onRendered();}},load:function(fn){var me=this;this.loadModelData(function(Aa){me.loadStencilData(Aa,function(Ba){var Ca=me.frame.Ajax.Request.prototype.initialize;me.frame.Ajax.Request.prototype.initialize=function(Da,Ea){if(Da.indexOf(Aa.stencilset.url)>=0&&"function"===typeof Ea.onSuccess){Ea.onSuccess.call(this,{responseText:me.frame.Object.toJSON(Ba)})}
else{Ca.apply(this,arguments);}}
fn(Aa);});});},loadModelData:function(fn){var Fa=this.config.url+"/json?",model,me=this;if(this.config.authToken){Fa+="authkey="+(this.config.authToken.split("_")[1]||this.config.authToken);}
this.loadData(Fa,fn);},loadStencilData:function(Ga,fn){var Ha=this.config.url.split("/").slice(0,3).join("/")+"/p/editor_stencilset?";Ha+="embedsvg=true";Ha+="&namespace="+(Ga.stencilset.namespace||Ga.stencilset.url).replace("#","%23");if(this.config.authToken){Ha+="&authkey="+(this.config.authToken.split("_")[2]||"");}
this.loadData(Ha,fn);},loadData:function(Ia,fn){Ia=Ia.indexOf("?")>=0?Ia:Ia+"?";Ia=Ia.slice(Ia.length-2)=="?"?Ia:Ia+"&";var Ja="data_"+(Math.round(Math.random()*1000000000));Ia+="_dc="+(Math.round(Math.random()*1000000));Ia+="&jsonp=var "+(Ja)+"=";var Ka=this.frame.document.createElement("script"),me=this;Ka.setAttribute("type","text/javascript")Ka.setAttribute("src",Ia);Ka.addEventListener("load",function(){fn(me.frame[Ja]);delete me.frame[Ja];},true);this.frame.document.getElementsByTagName("head")[0].appendChild(Ka);},setupIFrame:function(){if(!this.config.element){throw new Error("The Mashup api needs an element.")}
var La=document.createElement("iframe");La.style.width=(this.config.width||"100%")+("number"==typeof this.config.width?"px":"");La.style.height=(this.config.height||"100%")+("number"==typeof this.config.height?"px":"");La.style.border="none";this.config.element.appendChild(La);this.document=La;return La;},writeContent:function(Ma){var Na=Ma.contentWindow,me=this,url=this.server,isDebug=this.config.isDebug===true,script='ORYX.CONFIG.ORYX_NEW_URL = "/";'+'ORYX.CONFIG.PANEL_LEFT_COLLAPSED = true;'+'ORYX._loadPlugins = function(){};'+'ORYX.CONFIG.BACKEND_SWITCH = false;'+'ORYX.CONFIG.EXPLORER_PATH ="'+url+'/explorer";'+'ORYX.CONFIG.BLANK_IMAGE = "'+url+'/libs/ext-2.0.2/resources/images/default/tree/loading.gif";';this.frame=Na;Na.document.write('<html xmlns="http://www.w3.org/1999/xhtml" xmlns:b3mn="http://b3mn.org/2007/b3mn" xmlns:ext="http://b3mn.org/2007/ext" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:atom="http://b3mn.org/2007/atom+xhtml">'+'<head profile="http://purl.org/NET/erdf/profile"><title>Mashup | Signavio</title>'+'<s'+'cript src="'+url+'/libs/prototype-1.5.1.js" type="text/javascript"></s'+'cript>'+'<s'+'cript src="'+url+'/libs/path_parser.js" type="text/javascript"></s'+'cript>'+'<s'+'cript src="'+url+'/libs/ext-2.0.2/adapter/ext/ext-base.js" type="text/javascript"></s'+'cript>'+'<s'+'cript src="'+url+'/libs/ext-2.0.2/ext-all-debug.js" type="text/javascript"></s'+'cript>'+'<s'+'cript src="'+url+'/libs/ext-2.0.2/color-field.js" type="text/javascript"></s'+'cript>'+'<s'+'cript src="'+url+'/libs/iscroll.js?version=4.2.0" type="text/javascript"></s'+'cript>'+'<style media="screen" type="text/css"> @import url("'+url+'/libs/ext-2.0.2/resources/css/ext-all.css"); @import url("'+url+'/libs/ext-2.0.2/resources/css/xtheme-darkgray.css"); </style>'+'<link rel="Stylesheet" media="screen" href="'+url+'/editor/css/theme_norm.css?version=4.2.0" type="text/css" />'+'<link rel="Stylesheet" media="screen" href="'+url+'/editor/css/theme_norm_signavio.css?version=4.2.0" type="text/css" />'+'<s'+'cript src="'+url+'/editor/i18n/translation_en_us.js?version=4.2.0" type="text/javascript"></s'+'cript>'+'<s'+'cript src="'+url+'/editor/i18n/translation_signavio_en_us.js?version=4.2.0" type="text/javascript"></s'+'cript>'+'<s'+'cript src="'+url+'/libs/utils.js?version=4.2.0" type="text/javascript"></s'+'cript>'+'<s'+'cript src="'+url+'/editor/oryx'+(isDebug?'.debug':'')+'.js?version=4.2.0" type="text/javascript"></s'+'cript>'+'<link rel="schema.dc" href="http://purl.org/dc/elements/1.1/" />'+'<link rel="schema.dcTerms" href="http://purl.org/dc/terms/" />'+'<link rel="schema.b3mn" href="http://b3mn.org" />'+'<link rel="schema.oryx" href="http://oryx-editor.org/" />'+'<link rel="schema.raziel" href="http://raziel.org/" />'+'<s'+'cript type="text/javascript">'+script+'</s'+'cript>'+'<s'+'tyle type="text/css">'+'.ORYX_Editor {'+'background:none repeat scroll 0 0 white !important;'+'border:none !important;'+'height:100% !important;'+'margin:0 !important;'+'overflow:auto !important;'+'width:100% !important;'+'}'+'</s'+'tyle>'+'</head>'+'<body style="overflow:hidden;" class="">'+'</body>'+'</html>');Na.document.close();Na.onOryxResourcesLoaded=function(){me.onLoaded();}},getPlugins:function(){var Oa=[{"name":"Signavio.Plugins.Loading","source":"signavio.js","properties":[]},{"name":"Signavio.Plugins.GlossaryRename","source":"glossaryRename.js","properties":[]},{"name":"ORYX.Plugins.Toolbar","source":"toolbar.js","properties":[]},{"name":"ORYX.Plugins.Loading","source":"loading.js","properties":[]},{"name":"ORYX.Plugins.ProcessLink","source":"processLink.js","properties":[],"requires":{"namespaces":["http://b3mn.org/stencilset/epc#","http://b3mn.org/stencilset/bpmn1.1#"]}},{"name":"ORYX.Plugins.Overlay","source":"overlay.js","properties":[]},{"name":"ORYX.Plugins.BPMN11","source":"bpmn11.js","properties":[],"requires":{"namespaces":["http://b3mn.org/stencilset/bpmn1.1#","http://b3mn.org/stencilset/timjpdl3#","http://b3mn.org/stencilset/jbpm4#"]}},{"name":"Signavio.Plugins.Linking","source":"linking.js","properties":[]},{"name":"ORYX.Plugins.ProcessmapSupport","source":"processmapSupport.js","properties":[],"requires":{"namespaces":["http://www.signavio.com/stencilsets/processmap#"]}},{"name":"ORYX.Plugins.OrganigramSupport","source":"organigramSupport.js","properties":[],"requires":{"namespaces":["http://www.signavio.com/stencilsets/organigram#"]}},{"name":"ORYX.Plugins.BPMN2_0","source":"bpmn2.0/bpmn2.0.js","properties":[],"requires":{"namespaces":["http://b3mn.org/stencilset/bpmn2.0#","http://www.signavio.com/saperion#","http://www.signavio.com/stencilsets/processmap#","http://b3mn.org/stencilset/bpmn2.0choreography#"]}},{"name":"ORYX.Plugins.BPMN2CONVERSATION","source":"bpmn2.0/bpmn2conversation.js","properties":[],"requires":{"namespaces":["http://b3mn.org/stencilset/bpmn2.0conversation#"]}},{"name":"ORYX.Plugins.Bpmn2_0Choreography","source":"bpmn2.0/bpmn2.0choreography.js","properties":[],"requires":{"namespaces":["http://b3mn.org/stencilset/bpmn2.0choreography#"]}}];for(var i=0,size=Oa.length;i<size;++i){if(Oa[i].requires){Oa[i].requires.namespaces=this.$A(Oa[i].requires.namespaces);}
Oa[i].properties=this.$A([]);}
return this.$A(Oa);},getShapeSize:function(){var x1,y1,x2,y2,me=this;if(this.Ext.isIE9){var bb=this.editor.getCanvas().getRootNode().childNodes[1].childNodes[0].childNodes[1].getBBox();x1=bb.x;y1=bb.y;x2=bb.x+bb.width;y2=bb.y+bb.height;var Pa=function(Qa,Ra,Sa,Ta){if(!Qa&&!Ra&&!Sa&&!Ta){return;}
x1=Math.min(x1,Qa);y1=Math.min(y1,Ra);x2=Math.max(x2,Sa);y2=Math.max(y2,Ta);}
this.editor.getCanvas().getChildShapes(false).each(function(Ua){if(Ua instanceof me.ORYX.Core.Edge){Pa(Ua.bounds.a.x,Ua.bounds.a.y,Ua.bounds.b.x,Ua.bounds.b.y);Ua.getLabels().each(function(Va){var Wa=Va.node.getBBox();Pa(Wa.x,Wa.y,Wa.x+Wa.width,Wa.y+Wa.height);})}})}
else{try{var pe=9;var Xa=this.editor.getCanvas().getRootNode().childNodes[1].childNodes[0].childNodes[1].getBBox();var Ya=this.editor.getCanvas().getRootNode().childNodes[1].childNodes[0].childNodes[2].getBBox();if(!Xa.x&&!Xa.y&&!Xa.width&&!Xa.height){Xa=Ya;}
if(!Ya.x&&!Ya.y&&!Ya.width&&!Ya.height){Ya=Xa;}
x1=Math.min(Xa.x,Ya.x+pe);y1=Math.min(Xa.y,Ya.y+pe);x2=Math.max(Xa.x+Xa.width,Ya.x+Ya.width-pe);y2=Math.max(Xa.y+Xa.height,Ya.y+Ya.height-pe);}
catch(e){var Za;this.editor.getCanvas().getChildShapes(true).each(function($a){var ab=$a.absoluteBounds();if(!Za){Za=ab.clone();}
else{Za.include(ab)}});return Za;}}
return new this.ORYX.Core.Bounds(x1,y1,x2,y2);}};(window.addEventListener||window.attachEvent)("load",function(){var cb=document.getElementsByTagName("script");for(var i=0,size=cb.length;i<size;++i){var db=cb[i];if(db&&!db.getAttribute("src")&&(db.getAttribute("type")||"").toLowerCase()==="text/plain"){var eb={};try{(function(){eval("config = "+db.textContent)}());if(eb&&eb instanceof Object&&"string"==typeof eb.url){eb.element=db.parentNode;new aa(eb);}}
catch(e){}}}},false);}())